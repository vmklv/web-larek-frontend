# Проектная работа "Веб-ларек"

Стек: HTML, SCSS, TS, Webpack

Структура проекта:
- src/ — исходные файлы проекта
- src/components/ — папка с JS компонентами
- src/components/base/ — папка с базовым кодом

Важные файлы:
- src/pages/index.html — HTML-файл главной страницы
- src/types/index.ts — файл с типами
- src/index.ts — точка входа приложения
- src/scss/styles.scss — корневой файл стилей
- src/utils/constants.ts — файл с константами
- src/utils/utils.ts — файл с утилитами

## Установка и запуск
Для установки и запуска проекта необходимо выполнить команды

```
npm install
npm run start
```

или

```
yarn
yarn start
```
## Сборка

```
npm run build
```

или

```
yarn build
```

# Архитектура приложения

Приложение построено по принципу MVP (Model-View-Presenter), который разделяет ответственность между компонентами для повышения тестируемости и гибкости.

- **Model** — управляет данными и взаимодействует с сервером.
- **View** — отвечает за отображение данных и обработку пользовательских событий.
- **Presenter** — служит промежуточным звеном, соединяя модель и представление.


## Основные классы

### Класс `Api`

**Описание**:  
Класс предназначен для работы с сервером через HTTP-запросы. Его задача — предоставление удобных методов для отправки запросов и получения данных.

**Поля**:
- `baseUrl: string` — базовый URL для API, который используется в запросах.
- `options: RequestInit` — параметры для запроса.

**Методы**:
- `get` — выполняет GET-запрос к указанному endpoint и возвращает промис с результатом.
- `post` — отправляет данные в формате JSON на указанный endpoint, можно указать метод запроса (по умолчанию используется POST).

---

### Класс `EventEmitter`

**Описание**:  
Класс обеспечивает обработку событий в приложении, позволяя генерировать события и подписываться на них.

**Методы**:
- `on` — подписка на событие.
- `emit` — инициализация события.
- `trigger` — возвращает функцию, при вызове которой инициализируется требуемое в параметрах событие.

---

### Класс `AppState`

**Описание**:  
Класс представляет собой модель данных всего приложения и включает в себя основные группы данных, а также методы для работы с ними.

**Поля**:
- `items: IProduct[]` — массив объектов товаров приложения.
- `basket: IProduct[]` — массив объектов товаров, добавленных в корзину.
- `order: IOrder` — информация о заказе при покупке товара.
- `preview: string` — превью для карточек.
- `userData: IUser` — данные пользователя.
- `formErrors: FormErrors` — ошибки формы.

**Методы**:
- `getItems` — метод для получения списка доступных товаров. 
- `getTotalBasket` — метод, возвращающий общее количество товаров в корзине. 
- `getTotalBasketPrice` — метод для получения общей стоимости товаров в корзине. 
- `setOrderField`: устанавливает значение поля заказа. 
- `validateContact` — метод для проверки корректности контактных данных. 
- `validateOrder` — метод для проверки корректности заказа. 
- `hasProductInBasket` — проверяет наличие товара в корзине. 
- `clearOrder` — очищает данные заказа. 
- `clearBasket` — метод для очистки содержимого корзины. 
- `deleteBasket` — метод для удаления товара из корзину. 
- `addBasket` — метод для добавления товара в корзину. 

---

### Класс `Page`

**Описание**:  
Класс отвечает за отображение контента, видимого пользователю при входе на страницу, включая список карточек товаров, корзину и количество товаров в ней. Он является расширением базового абстрактного класса `Component` и реализует интерфейс `IProductData`.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Поля**:
- `basketCounter` — содержит разметку счётчика товаров в корзине.
- `productOnPage` — хранит карточки товаров, отображаемые на странице.
- `wrapper` — включает общую разметку страницы.
- `basket` — представляет кнопку для доступа к корзине.

**Методы**:
- `set catalog` — отвечает за отображение карточек товаров.
- `set locked` — устанавливает класс, блокирующий прокрутку страницы.
- `set counter` — обновляет отображение счётчика товаров в корзине.

---

### Класс `Cards`

**Описание**:  
Класс предназначен для отображения данных карточки товара в различных элементах интерфейса, включая каталог, модальное окно отдельной карточки и каталог корзины.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Поля**:
- `id` — идентификатор карточки.
- `description` — описание карточки.
- `image` — разметка изображения карточки.
- `title` — разметка заголовка карточки.
- `category` — разметка категории карточки.
- `price` — разметка цены карточки.

**Методы**:
- `setData(cardData: IProduct)` — заполняет атрибуты элементов карточки данными.

---

### Класс `Modal`

**Описание**:  
Класс отвечает за управление отображением модального окна. Он наследует от базового абстрактного класса `Component` и предоставляет функциональность для открытия и закрытия модального окна.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Поля**:
- `closeButton` — элемент разметки кнопки для закрытия модального окна.
- `content` — элемент разметки контейнера для размещения содержимого модального окна.

**Методы**:
- `open` — открывает модальное окно.
- `close` — закрывает модальное окно.
- `render` — отображает содержимое.

---

### Класс `Basket`

**Описание**:  
Класс представляет собой реализацию корзины товаров и наследует функциональность базового абстрактного класса `Component`. Он отвечает за отображение содержимого корзины, а также за отображение количества товаров и общей стоимости.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Поля**:
- `productListElement` — элемент, отвечающий за отображение списка карточек товаров.
- `totalElement` — элемент, отображающий общую сумму товаров в корзине.
- `button` — элемент, используемый для отображения стоимости всей корзины.

**Методы**:
- `setList` — устанавливает товары в разметку.
- `setTotal` — обновляет значение общей суммы товаров.

---

### Класс `Form`

**Описание**:  
Класс отвечает за управление формами в приложении, а также за валидацию введённых данных и отображение ошибок ввода на соответствующей форме. Он является наследником базового абстрактного класса `Component`.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Поля**:
- `submitButton` — разметка кнопки для отправки формы.
- `errors` — разметка для отображения ошибок валидации.

**Методы**:
- `changesInForm` — регистрирует событие, связанное с конкретным полем.
- `valid` — устанавливает состояние валидности формы.
- `render` — отображает форму и её элементы.

---

### Класс `Order`

**Описание**:  
Класс предназначен для отображения выбора метода оплаты и адреса покупателя в модальном окне. Он является расширением класса `Form` и реализует интерфейс `IOrder`.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Поля**:
- `buttonPay` — разметка кнопок формы оплаты.

**Методы**:
- `set Payment` — устанавливает класс активности на кнопку.
- `set Address` — устанавливает значение поля адреса.
- `disableButtons` — убирает выделение с кнопок.

---

### Класс `Contacts`

**Описание**:  
Класс отвечает за отображение контактов покупателя в модальном окне и расширяет класс `Form` в соответствии с интерфейсом `IOrder`.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Методы**:
- `set Phone` — устанавливает значение поля для номера телефона.
- `set Email` — устанавливает значение поля для электронной почты.

---

### Класс `Success`

**Описание**:  
Класс предназначен для отображения информации о успешной покупке. Он является производным от базового абстрактного класса `Component`.

**Конструктор**:  
`constructor(container: HTMLElement, actions: ISuccessAction)`

**Поля**:
- `totalAmount` — хранит информацию о общей сумме товаров в заказе.

**Методы**:
- `setTotal` — устанавливает значение общей суммы заказа.

---

### Класс `Card`

**Описание**:  
Класс предназначен для визуализации данных о товаре в модальном окне, корзине и каталоге корзины. Он является расширением базового класса `IProduct`.

**Конструктор**:  
`constructor(container: HTMLElement, action?: ICardAction)`

**Поля**:
- `_title` — разметка заголовка карточки.
- `_price` — разметка цены карточки.
- `_button?` — разметка кнопки.
- `_index?` — разметка порядкового номера товара в заказе.

**Методы**:
- `set id` — устанавливает идентификатор карточки.
- `set price` — задает стоимость карточки.
- `set title` — задает заголовок карточки.
- `set button` — задает заголовок кнопки.
- `set index` — устанавливает порядковый номер карточки в корзине.

---

### Класс `CardOnPage`

**Описание**:  
Класс наследуется от класса `Card` и представляет собой карточку, которая отображается на странице. Этот класс расширяет функциональность класса `Card`.

**Конструктор**:  
`constructor(container: HTMLElement, action?: ICardAction)`

**Поля**:
- `_image` — разметка изображения для карточки.
- `_category` — разметка категории для карточки.

**Методы**:
- `set image` — устанавливает изображение для карточки.
- `set category` — устанавливает категорию для карточки.

---

### Класс `CardInfo`

**Описание**:  
Класс отвечает за отображение данных предварительного просмотра карточек товаров и расширяет класс `CardOnPage`.

**Конструктор**:  
`constructor(container: HTMLElement, action?: ICardAction)`

**Поля**:
- `_description` — описание карточки.

**Методы**:
- `set description` — устанавливает описание карточки.

---

### Класс `Page`

**Описание**:  
Класс отвечает за отображение критически важных элементов на странице, таких как каталог товаров, корзина и счетчик товаров в корзине. Он является расширением базового класса `Component` и реализует интерфейс `IPage`.

**Конструктор**:  
`constructor(container: HTMLElement, events: IEvents)`

**Поля**:
- `hdrBasketCounter` — разметка счетчика товаров в корзине.
- `gallery` — разметка галереи товаров.
- `pageWrapper` — разметка обертки страницы.
- `hdrBasket` — разметка кнопки корзины.

**Методы**:
- `set counter` — отображает счетчик товаров в корзине.
- `set catalog` — отображает карточки товаров на странице.
- `set locked` — блокирует прокрутку страницы.